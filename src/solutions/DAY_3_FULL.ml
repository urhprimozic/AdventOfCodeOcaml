let test_list =
  [
    "..#..#......#..#.......#...#.#.";
    "...##.....##..#..#....#.##.##.#";
    "...#...#.##...##.....#.....#.#.";
    "..#....#.....#...##.##.###.#...";
    ".#.....#......#..#.##.#...###..";
    "#..#..#.#......#...........###.";
    "#......####.#....##........##..";
    ".#.......#.....#......#...#....";
    "...#...#.....#.......##.....##.";
    "#...##.........#.#..##..#..#.##";
    "#.#.##.........#.#..#.#.....###";
    ".##..##...#....##.....#..#.....";
    "........#.......###.#.#.....#.#";
    "...#.#....#.##..#...##..##..#..";
    "......#....#........######.#...";
    ".##...#.#...###......#.#.#..#.#";
    "........#.##...##.#...#..#...##";
    ".#..#.#..##....###..#.#.......#";
    "..#..##..#.#...#.##......#.....";
    "##.....#..##.#.#..#......##...#";
    "......................#..#..#..";
    "..#.##....####.........###.##..";
    "##..###..#...#....#..#.#...#...";
    ".##.#......#..#....#........#..";
    ".#.....#..#..#.#.#....#.....##.";
    "..........#..#....#..##...#..##";
    ".#...#.#....#.##..#.....#....#.";
    "#..............#.#.#..#..#....#";
    "...#.#...............##........";
    "#.#.##...#.##..##.....#........";
    "...#.......###..###..#...#..#..";
    "####..#.#..##.....##.#.#......#";
    ".#.#.......#..##.......#.......";
    "#....#...#.##.#.......#..#.....";
    ".#...##..#..#..##.......##...#.";
    ".#..#......#.........#.........";
    "#.##.#.....#....#..##..#.....#.";
    "#.#....#.#....#...#.#..#....#..";
    "#..#.....#.##..#.....#...##...#";
    "#....#...##.#.........#.#....##";
    ".......##.##......##.......##..";
    "#.....#..#........#........#...";
    "#....#.#..#.#........##.#...#..";
    "#.......#.#.#.#....#.......##.#";
    "...#..###..........#...#.#.###.";
    "....#..#....#...#....##.#.....#";
    ".#..##.....#..#....##..##...#.#";
    "#.........#....#.#..###...##...";
    ".#.#.........#.#.......#.#.#..#";
    "..........#........##..#.......";
    ".....#.......#...#.....#..##.##";
    "...#.........#.............####";
    "##..#...#..#.#......#...#......";
    ".#..###...#.#.#.#...#...#......";
    "....#..##.#....#..#.#..##..##.#";
    "..#.......#......#..#.......#..";
    "....###......#...##...#....#...";
    "..#..#.....#...#..###....#.#..#";
    ".........##..#.##....#..##..#..";
    "##...#...#.#.........##......#.";
    "###..#.#....#......##..##.#...#";
    ".##...##..#.#.#.#......#..#....";
    "###......#..#..#.....#..#....#.";
    ".#.#..##....##........##..#.#..";
    "###...####.#....#.......###....";
    "..#....###..#.#.#..#.......##..";
    ".......#.#...#.....#.#....##.#.";
    "......#......#.#....#..##..###.";
    "....####..........#.....#......";
    ".###.....#...#..#...##.#...###.";
    "...##....##....###....#.#..#.#.";
    "##.#..........##.........#.##..";
    "..#..#.#.###..##..#....##.....#";
    "..#....##.....#...##....###..##";
    "....#.......##..#..#..........#";
    "............#..#.###..#.#......";
    "...........##......#.#.#...#..#";
    "...##.##....#...##.##.....#.#..";
    ".####...#....###...#.....#....#";
    ".##........#..##..#.#.....#....";
    "..................#.....#..##..";
    "..###.....#.##..#..#....##...#.";
    "...#.##.#.####.#.###.#....#..##";
    ".#....##..##......####.#####...";
    "#...#.#....##.........##....#..";
    "..#.##.....##.............#.##.";
    "###.....#.#..#..#......#.##.#..";
    "...#..##.....#...##...#......#.";
    ".##.#...#......##.#..##....#...";
    ".....##.....#......#.#.........";
    "#.....#.....#........##........";
    ".#......##...#..#.#....###.#..#";
    "#.####...#....#.........#..#...";
    "#..##.#.....#.##.##.#....#...#.";
    "#########..#....#..#...#......#";
    "..##..##...###.######...##.##..";
    "##.......#.......#.#....###..#.";
    ".....#...#.######..#.....#.....";
    ".#......#..#.............#.##.#";
    "..###.#.#......##...###........";
    ".......####.#..##....#........#";
    "..#......#.##....##.##....#....";
    "....#......#.#....#..#.#.....##";
    "####.....#....#.#......#.#.#.##";
    "#...##....#.#.##.........#....#";
    "....#..###......#......#...#...";
    ".....##.#..#..#...#..#.#.#.....";
    ".##............#.....#.........";
    "##...#..#.....##.#..#..........";
    "#.....#####.......#..#....#.#..";
    ".........#..#.....###........#.";
    "#....#..#...###........#..#.#..";
    "...##...#..#...#.##..#.........";
    ".........#.#.....#.......#...#.";
    ".#.....#..####....#.##.......##";
    "...............##....##.##..##.";
    "............#....#....#...##.#.";
    "..#...#........#.......#..#....";
    "##....####....#.##...#..##..#.#";
    ".#.#.....#......#.#........#.#.";
    "....#......#.#....##..##.......";
    ".#..#.#..#..##.....#...........";
    "..#........#.##..#......##..#..";
    "...##.#...#...#..#........#....";
    "##..##....#......#...#..#.#.#.#";
    "......#.....#..#..#....#.......";
    ".....##......#..#.#.##...#.....";
    "...#.....#.#..........#..##...#";
    ".####.##....#...........#.....#";
    ".....###..##...#....##..#...#..";
    "..##...#.#...#..........#..#.#.";
    "...#..#..............#.##.#....";
    "##.#....#...#..#....#..........";
    ".##..........#..#........#.....";
    "#...#.#......#...#.....##..#...";
    ".##...#.#.#....###.####..#....#";
    ".#......#.#...#.#....#.#...#...";
    "#....##.###.............#.#....";
    "....#.###..##..##.##...##......";
    "##....#..###.##.##.....#......#";
    "..#..#..#......#..#..#.........";
    "#.##......#.#....#..#..#.......";
    "....#.#...#..###......##.......";
    ".###.......##.......#....###...";
    "..#..#.##..#.#....#..#.#.....#.";
    ".#..##.##..............#....#..";
    "#...#.#...#..#.##..##.#.#......";
    "#...#..#..##..##.###......#....";
    ".#..#.....#...#....#.....#...#.";
    ".....#....#..#.....###...#.####";
    ".#.....#......#...##...#..#....";
    ".#......#............#.#.......";
    "....##....#.#..#..#...#..#.#...";
    "#...#.....###...##...#.##.....#";
    ".......#.....#....#.......#...#";
    "#.......###.......#.#..........";
    "...#.#.###.#........#.###...#..";
    "....#............#....#..#.....";
    "#......#.##.#...##.......#..#.#";
    ".....#....#....#.#.#...###..#..";
    ".....#.#...#...#.#..#....#.#..#";
    ".#.......#.#..#...###.......##.";
    ".......#..#.##.........#.......";
    ".##.#........#.##...##....#....";
    ".#....#..#...#......####...#..#";
    "...#.....#..##.#..#.#....#....#";
    "...##....#........#.#........#.";
    ".....#....##..#.##..........#..";
    "#.....#.#.#......##....##.#..#.";
    ".#.#.##..#.#....##.#....##.....";
    ".....#.....#..#.#....#..#....##";
    "...#........#....#......###.#..";
    ".....##...#.....##.##.#.#.##...";
    "...#.....#####....##.#.#.###.#.";
    ".#..#.#..##...###.........#.#.#";
    "#...#...#.#..#...#...........#.";
    ".##..............#...#..#....#.";
    "....###.........#.#.#....#.....";
    "..#...##.#.#....##.#..#...#..#.";
    "..#.....#.#......#....#......#.";
    ".......##....#.#.##....#...#..#";
    "##.#.#...#..#......#..#..#....#";
    "...#.#......#............###.##";
    "..###..#..##..#...##........#..";
    ".#...#...##...#....#....##.#..#";
    "..##...####....#....#..#....#.#";
    "...#......##....#.........##.#.";
    "##.#.......#..#..#.............";
    "..#.#.#.#......#...#.#..##.....";
    ".#..##.....###...##.#..#......#";
    "##...#..........#.####....##...";
    "#..........#...#..##....#......";
    "....##...#....#..####...#.##.##";
    ".#.######...##...#..##.........";
    "....##.........#.......##.##...";
    ".#.....#.#..........##......#..";
    "...#..#.#.###..#........#.....#";
    "..##..#............##.......#..";
    "......##....##..#.##..#.......#";
    ".......##....#.......#..#...#.#";
    "#.#......#.###.....#.##........";
    ".#..##..........#..#.....#.##..";
    "..#.#...#....#.........#..##..#";
    ".#......#.......#...#..#..###..";
    "......#.##.....#.#......#....#.";
    "....#....#...#.......#...##.##.";
    "#....#...##...#..##........###.";
    "##......#.#..#.......#.......#.";
    "...##.##..#......#.###..#.#.##.";
    ".............#..#.............#";
    "..#.......##..#..#....##...#...";
    "...............##..##........#.";
    "##...#.##.......#....#.......##";
    "....##.##.#.#.....##.....##.##.";
    "#.#......#.......#..#.#..#.....";
    "....##....#.##........##.##.#..";
    "......##....#..##..#..##....##.";
    ".............#.....#.......#...";
    ".......###.......#..........#..";
    "......##.#..#.....#.#...#.#...#";
    ".#...#..#..###.###...#....##...";
    "#......#..#.#...#...#.....#..##";
    ".###.....#..#.#......##..#.##..";
    ".##.#.....#..#.#..#....##......";
    "#......#..............#.....#.#";
    "...#..#....#.....#.....##.#...#";
    "......#..##..##.....#...#......";
    ".....####..#..#.##.......#..#.#";
    "###.#.#........#.......#.....##";
    "..#.#.#.#...#...#........#....#";
    "....##.#.#..#...##.....#......#";
    "#..#.##....#..#.##..####.......";
    "...####.#...#......#......##..#";
    "#....#.#..###......#..#..##..#.";
    "...........#....#...#......#...";
    "......###.#.....#.#....#.#...#.";
    ".......#.##..............#..##.";
    "..##...........#..#.#...#.....#";
    "#..#............##.........#.#.";
    ".......###.#...#.#...#.#.#...#.";
    "..#...##.......#..#......#.#.##";
    "#.#...#.....#...##.#.#.......##";
    ".#.#.##...#..##.#......#.......";
    "#.......#.......#.#....#.....#.";
    ".....#..#..#.......#..#........";
    "##...##...##......#..##.###....";
    "..#...#.###.#.###..#.....###...";
    ".....####.......#.#.....##....#";
    "....#....#.#....#...#..#.#..#..";
    "..##.....#....#.#.#.###...#....";
    "......#.#....#.#..#....#.#..#..";
    "#...#...#....#.......#......#.#";
    "#..#.#......#..#...........#.##";
    "...............#....#.....#...#";
    ".#.#.#...#.##...#.#.#..#....#..";
    "...#.#.####..##.#...##.........";
    "##.........##.##.....##....#...";
    "................#...#.##.#.#..#";
    ".#..#....#...#..#..#..###.#..#.";
    "...#..#.##.#.####..........#..#";
    "........#....##......#..#.#....";
    "........##.........#..#..#..#.#";
    "#......#.#...#...#...##.....#..";
    "#...#.....#..#..##.#...#.#.#...";
    "....#..##...##.....#...#.#.....";
    "..#..##....#....#...#....#.....";
    ".#..#...##.......###...#...#...";
    ".#......#......#..##..#..##....";
    "....##....#..#.#....#.#..##....";
    "###......#...........#.....###.";
    ".....#...#..##.#..#..#.....#..#";
    "#.#....#...........#.##..#..###";
    "#....#...###.#...#..##..#.....#";
    ".#....#......##.#..#....#.#....";
    "....#.#....#..#.#....#..#..#...";
    "..#......#..#.#.#....#.........";
    ".#...#.#.....#........#.#...###";
    "....#..##.......#.###....##....";
    "#.#.......#......#.###........#";
    "#.........#.....####.##..#..#..";
    ".#.#..##...#.#.....##.#.#..#...";
    ".#..#..#..#.##..#...###.#...#..";
    ".....##..##..##..#.#.#.....###.";
    ".#..#...#..#......##.#.........";
    "....#..##....#.##.........#...#";
    "........#...#...###.........##.";
    "#.........#..##....#.#...#.....";
    ".......#.......#..#.......#....";
    "#......##......#.#.##..........";
    ".#..##..####...#.....####.....#";
    "........#.#....#..##..###.#...#";
    ".#...#...#.........###..#...#.#";
    "#.........#....##...#..........";
    ".#.#....#..........#...........";
    ".#.#..........#.##.....#.##....";
    "..#....#...##..###..........##.";
    ".#.#..#.##..#..#.##.##..##.....";
    "........#...#....#...#.#..##...";
    "......#......##..#..#.....#..#.";
    ".##.#....#...#....#...#..##..##";
    "##............#..........###...";
    "....#.......#.#..#.#####.....#.";
    "#......#.....#...#........#....";
    "..##.....###..#.#.#.#....#....#";
    "#...#...#.#..#..#....#..#......";
    "......#....#...#..#....#####...";
    "....#.......##....#....##......";
    ".....##...#.##.#.....##....#...";
    ".#....###.#..##...##.##.......#";
    "....#.#.#.##.............#..##.";
    "...........##......#...#.#.##..";
    "....##......#....#....##..##.#.";
    ".#.#...#.....##.....#.........#";
    "#.#..........#.......#.##...#..";
    "....#.##..#.#....#.....#...#...";
    "##.............##.......#.##.#.";
    "....#...#.....##...#..........#";
    "##..#...#...#.#.##...#.......##";
    "..#........#.....###...##..##.#";
    ".....#...##.#.#.##.....#...#...";
    "####.###...##..##...#..#..#..##";
    "......#..#..#.........#...#.#..";
    "....###.....##.##....#.##.....#";
  ]

let easy_test =
  [
    "..##.......";
    "#...#...#..";
    ".#....#..#.";
    "..#.#...#.#";
    ".#...##..#.";
    "..#.##.....";
    ".#.#.#....#";
    ".#........#";
    "#.##...#...";
    "#...##....#";
    ".#..#...#.#";
  ]

let vrednost = function '#' -> 1 | _ -> 0

let sirina = 31 (* 31 *)



let rec prestej_drevesa korak index = function
  | [] -> 0
  | vrsta :: ostanek ->
      vrednost vrsta.[index]
      + prestej_drevesa korak ((index + korak) mod sirina) ostanek

let rec prestej_vsako_drugo_drevo korak index index_y = function
  | [] -> 0
  | vrsta :: ostanek ->
      if index_y mod 2 == 0 then
        vrednost vrsta.[index]
        + prestej_vsako_drugo_drevo korak ((index + korak) mod sirina) (index_y + 1)
            ostanek
      else prestej_vsako_drugo_drevo korak index (index_y + 1) ostanek



let ans =
  prestej_drevesa 1 0 test_list
  * prestej_drevesa 3 0 test_list
  * prestej_drevesa 5 0 test_list
  * prestej_drevesa 7 0 test_list
  * prestej_vsako_drugo_drevo 1 0 0 test_list
